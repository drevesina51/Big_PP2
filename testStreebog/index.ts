import * as Stribog from "../scr/Stribog"
let outputMode = true
let t= new Stribog.Stribog(outputMode)
 let  message = [
     0x32,  0x31,  0x30,  0x39,  0x38,  0x37,  0x36,  0x35,
     0x34,  0x33,  0x32,  0x31,  0x30,  0x39,  0x38,  0x37, 
     0x36,  0x35,  0x34,  0x33,  0x32,  0x31,  0x30,  0x39, 
     0x38,  0x37,  0x36,  0x35,  0x34,  0x33,  0x32,  0x31,
     0x30,  0x39,  0x38,  0x37,  0x36,  0x35,  0x34,  0x33,
     0x32,  0x31,  0x30,  0x39,  0x38,  0x37,  0x36,  0x35,
     0x34,  0x33,  0x32,  0x31,  0x30,  0x39,  0x38,  0x37,
     0x36,  0x35,  0x34,  0x33,  0x32,  0x31,  0x30]


 let expResult = [
    0x48,  0x6f,  0x64,  0xc1,  0x91,  0x78,  0x79,  0x41, 
    0x7f,  0xef,  0x08,  0x2b,  0x33,  0x81,  0xa4,  0xe2, 
    0x11,  0xc3,  0x24,  0xf0,  0x74,  0x65,  0x4c,  0x38, 
    0x82,  0x3a,  0x7b,  0x76,  0xf8,  0x30,  0xad,  0x00, 
    0xfa,  0x1f,  0xba,  0xe4,  0x2b,  0x12,  0x85,  0xc0, 
    0x35,  0x2f,  0x22,  0x75,  0x24,  0xbc,  0x9a,  0xb1, 
    0x62,  0x54,  0x28,  0x8d,  0xd6,  0x86,  0x3d,  0xcc,
    0xd5,  0xb9,  0xf5,  0x4a,  0x1a,  0xd0,  0x54,  0x1b]

let result = t.getHash(message, outputMode)
if(expResult==result)
console.log("EZ")
else
console.log("NE_EZ")

// Test XOR
var a=[0,1,1,1]
var b=[0,0,1,0]
var c;
console.log(c=t.xor(a,b))
// TEST S-transformation 
var D=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63]
console.log(c=t.Stransformation(D))